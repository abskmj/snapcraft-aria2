name: Build
on:
  push:
    branches: [ feature/gh-action ]
#   schedule:
#     # run every day at midnight
#     - cron:  '0 0 * * *'
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Build
      run: |
        wget -c https://github.com/aria2/aria2/releases/download/release-1.35.0/aria2-1.35.0.tar.gz -O - | tar -xvz --directory ./
        cd aria2-1.35.0
        ./configure --with-ca-bundle='/etc/ssl/certs/ca-certificates.crt' ARIA2_STATIC=yes
        make
        ./src/aria2c -v
        tar -czvf aria2.tar.gz src/aria2c
        tar -ztvf aria2.tar.gz
        cd ..
    - name: Snapcraft
      run: |
        sudo snap install snapcraft --classic
        snapcraft
      env:
        SNAP_TOKEN: ${{secrets.SNAP_TOKEN}} 
        SNAPCRAFT_BUILD_ENVIRONMENT: host